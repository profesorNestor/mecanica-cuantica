<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Laboratorio de Espín, Color y Carga Cuántica</title>

  <!-- TailwindCSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Font Awesome -->
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
        integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet"/>
  <!-- KaTeX -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css"/>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.js"></script>

  <style>
    :root {
      --bg-a: #1e3a8a; --bg-b: #111827; --accent: #facc15;
      --card: rgba(255,255,255,.07); --border: rgba(255,255,255,.15);
      --text-primary: #e2e8f0; --text-secondary: #94a3b8; --text-dark: #0f172a;
      --reset-btn-bg: #be123c; --reset-btn-hover: #e11d48;

      /* Colores de espín */
      --spin-up-start: #67e8f9; --spin-up-end: #0ea5e9;
      --spin-down-start: #f9a8d4; --spin-down-end: #ec4899;

      /* Colores de carga de color */
      --r: #ef4444; --g: #22c55e; --b: #3b82f6;
      --ar: #06b6d4; --ag: #d946ef; --ab: #fde047;
    }
    body {
      font-family:'Inter',sans-serif;
      background:linear-gradient(135deg,var(--bg-a),var(--bg-b));
      color:var(--text-primary);
      margin:0; min-height:100vh;
      display:flex; flex-direction:column;
      overflow-x:hidden; position:relative;
    }
    h1,h2,h3 { color:var(--accent); font-weight:700 }
    h1 { text-shadow:2px 2px 4px rgba(0,0,0,.4); }
    .box {
      background:var(--card); border:1px solid var(--border);
      backdrop-filter:blur(8px); border-radius:.75rem;
      padding:1.5rem; margin-bottom:2rem;
      box-shadow:0 8px 16px rgba(0,0,0,.4);
    }
    /* Botón Inicio */
    .home-btn {
      position:fixed; top:20px; left:20px;
      background:rgba(255,255,255,.1); padding:10px 20px;
      border-radius:12px; font-weight:700;
      display:flex; align-items:center; gap:.5rem;
      color:var(--accent); text-decoration:none;
      transition:background .3s, transform .3s;
      z-index:100;
    }
    .home-btn:hover {
      background:rgba(250,204,21,.2); transform:scale(1.05);
    }
    @media(max-width:640px){
      .home-btn { padding:8px 12px; font-size:.875rem; }
      h1 { font-size:2.5rem; }
    }

    .section-title { text-align:center; font-size:1.75rem; margin-bottom:1.5rem; }
    .simulation-title { display:flex; align-items:center; justify-content:center; gap:.5rem;
      font-size:1.25rem; font-weight:600; margin-bottom:1rem; color:var(--accent);
    }
    .help-text { color:var(--text-secondary); font-size:.875rem; margin-bottom:1rem; text-align:center; }
    .simulation-box {
      border:1px solid var(--border); padding:1.25rem;
      border-radius:.5rem; background:rgba(0,0,0,.1);
      box-shadow:inset 0 1px 3px rgba(0,0,0,.2);
    }

    /* KaTeX fix */
    .katex { font-size:1.1em!important; }

    /* ==== ESPÍN ==== */
    .spin-card { perspective:900px; width:170px; height:210px; margin:auto; cursor:pointer; }
    .spin-inner {
      position:relative; width:100%; height:100%;
      transform-style:preserve-3d; transition:transform .7s cubic-bezier(.4,0,.2,1);
    }
    .spin-card.flipped .spin-inner { transform:rotateY(180deg); }
    .face {
      position:absolute; width:100%; height:100%;
      display:flex; flex-direction:column; align-items:center; justify-content:center;
      border-radius:1rem; backface-visibility:hidden;
      box-shadow:0 4px 10px rgba(0,0,0,.3); color:var(--text-dark);
    }
    .up { background:linear-gradient(145deg,var(--spin-up-start),var(--spin-up-end)); }
    .down {
      background:linear-gradient(145deg,var(--spin-down-start),var(--spin-down-end));
      transform:rotateY(180deg);
    }

    /* ==== COLOR ==== */
    .qbtn, .slot {
      width:55px; height:55px; border-radius:50%;
      display:flex; align-items:center; justify-content:center;
      font-weight:700; margin:.4rem;
      border:3px solid rgba(255,255,255,.45);
      box-shadow:0 2px 6px rgba(0,0,0,.3);
      transition:transform .25s,box-shadow .25s;
      color:var(--text-dark);
    }
    .qbtn:hover { transform:scale(1.08); box-shadow:0 4px 10px rgba(0,0,0,.4); }

    .slot {
      background:rgba(255,255,255,.1);
      color:var(--text-primary); border-style:dashed; font-size:1.5rem;
      width:60px; height:60px;
    }
    .slot.filled {
      border-style:solid;
      color: #fff;
    }
    /* rellenar segun color */
    .slot.filled.r { background: var(--r); }
    .slot.filled.g { background: var(--g); }
    .slot.filled.b { background: var(--b); }
    .slot.filled.ar { background: var(--ar); }
    .slot.filled.ag { background: var(--ag); }
    .slot.filled.ab { background: var(--ab); }

    .particle {
      width:80px; height:80px; border-radius:50%;
      display:flex; align-items:center; justify-content:center;
      font-weight:700; margin:1rem auto;
      border:3px solid var(--border);
      transition:background .4s,border-color .4s,box-shadow .4s;
      font-size:.9rem; text-align:center;
    }
    .particle.neutral { background:#fff; border-color:#fff; box-shadow:0 0 18px rgba(255,255,255,.7); }
    .particle.not-neutral { background:rgba(255,255,255,.08); }

    /* ==== CARGA ELÉCTRICA ==== */
    .flav-btn {
      margin:.3rem; padding:.5rem .8rem; border-radius:.5rem;
      font-weight:600; font-size:.85rem; background:rgba(255,255,255,.12);
      border:1px solid rgba(255,255,255,.3); cursor:pointer;
      transition:background .2s,transform .2s,border-color .2s;
      color:var(--text-primary); line-height:1.2;
    }
    .flav-btn:hover {
      background:rgba(250,204,21,.25); transform:scale(1.05);
      border-color:var(--accent);
    }
    .quark-btn { border-left:4px solid var(--g); }
    .anti-quark-btn { border-left:4px solid var(--ar); }

    .slot-chg {
      width:50px; height:50px; margin:.2rem;
      display:flex; align-items:center; justify-content:center;
      background:rgba(0,0,0,.2);
      border:2px dashed rgba(255,255,255,.4);
      border-radius:.5rem; font-weight:700;
      color:var(--text-secondary); font-size:1.1rem;
    }
    .slot-chg.quark-filled {
      border-color: var(--g);
      background: var(--g);
      color: #fff;
    }
    .slot-chg.anti-filled {
      border-color: var(--ar);
      background: var(--ar);
      color: #fff;
    }

    .charge-label {
      color: var(--accent); font-size:1.25rem; font-weight:700;
      min-width:3em; display:inline-block; text-align:center;
    }
    .particle-name {
      color: #67e8f9; font-weight:700; margin-top:.5rem;
    }

    .reset-button {
      margin-top:1rem; padding:.5rem 1rem;
      background:var(--reset-btn-bg); color:#fff;
      border:none; border-radius:.5rem;
      font-size:.875rem; font-weight:600; cursor:pointer;
      display:inline-flex; align-items:center; gap:.5rem;
      transition:background-color .2s,transform .2s;
    }
    .reset-button:hover {
      background:var(--reset-btn-hover); transform:scale(1.03);
    }
    .reset-button i { font-size:.8rem; }
  </style>
</head>
<body>

  <a href="index.html" class="home-btn" aria-label="Volver al inicio">
    <i class="fas fa-home"></i><span>Inicio</span>
  </a>

  <main class="container max-w-5xl mx-auto px-4 py-12 flex-1">
    <h1 class="text-center text-4xl md:text-5xl mb-16">
      Laboratorio de Espín, Color y Carga Cuántica
    </h1>

    <!-- ESPÍN -->
    <section class="box">
      <h2 class="section-title"><i class="fas fa-sync-alt mr-2"></i>Propiedad de Espín</h2>
      <div class="grid md:grid-cols-2 gap-8 items-center">
        <div>
          <h3 class="text-xl font-semibold mb-3 text-yellow-300">¿Qué es el espín?</h3>
          <p class="mb-3 text-sm">
            El <strong class="text-yellow-300">espín</strong> es un momento angular intrínseco. Dos orientaciones:
          </p>
          <ul class="list-disc list-inside text-sm mb-4 pl-4">
            <li><code>m<sub>s</sub> = +½</code> : Arriba (↑)</li>
            <li><code>m<sub>s</sub> = -½</code> : Abajo (↓)</li>
          </ul>
          <p class="help-text"><i class="fas fa-hand-pointer mr-1"></i>Haz clic en la tarjeta para girar el espín.</p>
        </div>
        <div class="flex justify-center">
          <div id="spinCard" class="spin-card">
            <div class="spin-inner">
              <div class="face up">
                <i class="fas fa-arrow-up text-5xl mb-3"></i>
                <div><code>+½</code></div>
                <div class="text-sm mt-1">Arriba</div>
              </div>
              <div class="face down">
                <i class="fas fa-arrow-down text-5xl mb-3"></i>
                <div><code>-½</code></div>
                <div class="text-sm mt-1">Abajo</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- COLOR -->
    <section class="box">
      <h2 class="section-title"><i class="fas fa-palette mr-2"></i>Propiedad de Carga de Color</h2>
      <p class="help-text mb-8">
        La carga de color une quarks. Los hadrones deben ser “blancos” (neutros en color).
      </p>
      <div class="grid md:grid-cols-2 gap-10">
        <!-- Barión color -->
        <div class="simulation-box text-center">
          <h3 class="simulation-title"><i class="fas fa-cubes"></i>Barión (3 quarks)</h3>
          <p class="help-text mb-4">Selecciona R, G y B en cualquier orden.</p>
          <div id="barButtons" class="flex justify-center flex-wrap mb-4"></div>
          <div class="flex justify-center items-center text-2xl font-bold gap-2 my-4">
            <span id="bSlot0" class="slot">?</span>+
            <span id="bSlot1" class="slot">?</span>+
            <span id="bSlot2" class="slot">?</span>
             =
            <div id="barStatus" class="particle not-neutral" aria-live="polite">
              <span id="barLabel">Vacío</span>
            </div>
          </div>
          <p id="barMsg" class="h-6 text-sm text-gray-300 font-medium"></p>
          <button id="barReset" class="reset-button">
            <i class="fas fa-undo"></i>Reiniciar Barión
          </button>
        </div>
        <!-- Mesón color -->
        <div class="simulation-box text-center">
          <h3 class="simulation-title"><i class="fas fa-atom"></i>Mesón (quark + antiquark)</h3>
          <p class="help-text mb-2">Primero quark, luego antiquark.</p>
          <p class="text-xs font-semibold mb-1">Quarks:</p>
          <div id="mesButtonsQ" class="flex justify-center flex-wrap mb-3"></div>
          <p class="text-xs font-semibold mb-1">Antiquarks:</p>
          <div id="mesButtonsAQ" class="flex justify-center flex-wrap mb-4"></div>
          <div class="flex justify-center items-center text-2xl font-bold gap-2 my-4">
            <span id="mSlot0" class="slot">?</span>+
            <span id="mSlot1" class="slot">?</span>
             =
            <div id="mesStatus" class="particle not-neutral" aria-live="polite">
              <span id="mesLabel">Vacío</span>
            </div>
          </div>
          <p id="mesMsg" class="h-6 text-sm text-gray-300 font-medium"></p>
          <button id="mesReset" class="reset-button">
            <i class="fas fa-undo"></i>Reiniciar Mesón
          </button>
        </div>
      </div>
    </section>

    <!-- CARGA ELÉCTRICA -->
    <section class="box">
      <h2 class="section-title"><i class="fas fa-bolt mr-2"></i>Propiedad de Carga Eléctrica</h2>
      <p class="help-text mb-8">
        Quarks tienen cargas ±⅔e y antiquarks ∓⅓e. Combínalos para ver la carga total y el nombre de la partícula.
      </p>
      <div class="grid md:grid-cols-2 gap-10">
        <!-- Barión eléctrico -->
        <div class="simulation-box text-center">
          <h3 class="simulation-title"><i class="fas fa-cubes"></i>Barión (3 quarks)</h3>
          <p class="help-text mb-4">Haz clic en 3 sabores de quark:</p>
          <div id="chgButtonsBar" class="flex justify-center flex-wrap mb-4"></div>
          <div class="flex justify-center items-center mb-2 text-xl font-bold gap-1">
            <div id="slotCh0" class="slot-chg">?</div>+
            <div id="slotCh1" class="slot-chg">?</div>+
            <div id="slotCh2" class="slot-chg">?</div>
             =
            <span id="resultBar" class="charge-label" aria-live="polite"></span>
          </div>
          <div id="nameBar" class="particle-name" aria-live="polite">Barión desconocido</div>
          <button id="resetChBar" class="reset-button">
            <i class="fas fa-undo"></i>Reiniciar Barión
          </button>
        </div>

        <!-- Mesón eléctrico -->
        <div class="simulation-box text-center">
          <h3 class="simulation-title"><i class="fas fa-atom"></i>Mesón (quark + antiquark)</h3>
          <p class="help-text mb-4">Elige 1 quark y 1 antiquark:</p>
          <p class="text-xs font-semibold mb-1">Quarks:</p>
          <div id="chgButtonsMesQ" class="flex justify-center flex-wrap mb-3"></div>
          <p class="text-xs font-semibold mb-1">Antiquarks:</p>
          <div id="chgButtonsMesAQ" class="flex justify-center flex-wrap mb-4"></div>
          <div class="flex justify-center items-center mb-2 text-xl font-bold gap-1">
            <div id="slotChQ" class="slot-chg">?</div>+
            <div id="slotChAQ" class="slot-chg">?</div>
             =
            <span id="resultMes" class="charge-label" aria-live="polite"></span>
          </div>
          <div id="nameMes" class="particle-name" aria-live="polite">Mesón desconocido</div>
          <button id="resetChMes" class="reset-button">
            <i class="fas fa-undo"></i>Reiniciar Mesón
          </button>
        </div>
      </div>
    </section>
  </main>

  <footer class="text-center text-xs text-gray-500 py-6 mt-8">
    © 2025 Laboratorio Interactivo de Partículas — Renderizado con KaTeX
  </footer>

  <script>
    // KaTeX utility
    function renderKaTeX(expr, el, display=false) {
      if (!el) return;
      if (window.katex) katex.render(expr, el, {throwOnError:false, displayMode:display});
      else setTimeout(()=>renderKaTeX(expr,el,display),50);
    }

    // SPIN
    document.getElementById('spinCard')
      .addEventListener('click', e=> e.currentTarget.classList.toggle('flipped'));

    // COLOR
    const COLORS = {
      R:{cls:'r',tex:'R',anti:'AR'},
      G:{cls:'g',tex:'G',anti:'AG'},
      B:{cls:'b',tex:'B',anti:'AB'},
      AR:{cls:'ar',tex:'\\bar{R}',anti:'R'},
      AG:{cls:'ag',tex:'\\bar{G}',anti:'G'},
      AB:{cls:'ab',tex:'\\bar{B}',anti:'B'}
    };
    function makeColorBtn(c){
      const b=document.createElement('button');
      b.className=`qbtn ${COLORS[c].cls}`;
      b.dataset.code=c;
      renderKaTeX(COLORS[c].tex,b);
      return b;
    }
    // Barión color
    let barCol=[];
    const barSlots=['bSlot0','bSlot1','bSlot2'].map(id=>document.getElementById(id));
    const barBtns=document.getElementById('barButtons');
    const barStatus=document.getElementById('barStatus');
    const barLabel =document.getElementById('barLabel');
    const barMsg   =document.getElementById('barMsg');
    ['R','G','B'].forEach(c=>barBtns.appendChild(makeColorBtn(c)));
    barBtns.addEventListener('click',e=>{
      const c=e.target.closest('button')?.dataset.code;
      if(c&&barCol.length<3){ barCol.push(c); updBarColor(); }
    });
    document.getElementById('barReset').onclick=()=>{
      barCol=[]; updBarColor();
    };
    function updBarColor(){
      barSlots.forEach((s,i)=>{
        if(barCol[i]){
          s.className=`slot filled ${COLORS[barCol[i]].cls}`;
          renderKaTeX(COLORS[barCol[i]].tex,s);
        } else {
          s.className='slot'; s.textContent='?';
        }
      });
      const ok=['R','G','B'].every(x=>barCol.includes(x));
      if(barCol.length===0){
        barStatus.className='particle not-neutral'; barLabel.textContent='Vacío';
        barMsg.textContent='Selecciona 3 quarks'; barMsg.style.color='var(--text-secondary)';
      } else if(ok){
        barStatus.className='particle neutral'; barLabel.textContent='¡Blanco!';
        barMsg.textContent='Barión neutro en color'; barMsg.style.color='var(--accent)';
      } else {
        barStatus.className='particle not-neutral'; barLabel.textContent='Colorido';
        barMsg.textContent=barCol.length<3?'Faltan quarks…':'No es blanco';
        barMsg.style.color='var(--text-primary)';
      }
    }
    updBarColor();

    // Mesón color
    let mesQ=null, mesAQ=null;
    const mesSlots=[document.getElementById('mSlot0'),document.getElementById('mSlot1')];
    const mesBtnsQ=document.getElementById('mesButtonsQ');
    const mesBtnsAQ=document.getElementById('mesButtonsAQ');
    const mesStatus=document.getElementById('mesStatus');
    const mesLabel=document.getElementById('mesLabel');
    const mesMsg=document.getElementById('mesMsg');
    ['R','G','B'].forEach(c=>mesBtnsQ.appendChild(makeColorBtn(c)));
    ['AR','AG','AB'].forEach(c=>mesBtnsAQ.appendChild(makeColorBtn(c)));
    mesBtnsQ.addEventListener('click',e=>{
      const c=e.target.closest('button')?.dataset.code;
      if(c){ mesQ=c; updMesColor(); }
    });
    mesBtnsAQ.addEventListener('click',e=>{
      const c=e.target.closest('button')?.dataset.code;
      if(c){ mesAQ=c; updMesColor(); }
    });
    document.getElementById('mesReset').onclick=()=>{
      mesQ=mesAQ=null; updMesColor();
    };
    function updMesColor(){
      if(mesQ){
        mesSlots[0].className=`slot filled ${COLORS[mesQ].cls}`;
        renderKaTeX(COLORS[mesQ].tex,mesSlots[0]);
      } else {
        mesSlots[0].className='slot'; mesSlots[0].textContent='?';
      }
      if(mesAQ){
        mesSlots[1].className=`slot filled ${COLORS[mesAQ].cls}`;
        renderKaTeX(COLORS[mesAQ].tex,mesSlots[1]);
      } else {
        mesSlots[1].className='slot'; mesSlots[1].textContent='?';
      }
      if(!mesQ&&!mesAQ){
        mesStatus.className='particle not-neutral'; mesLabel.textContent='Vacío';
        mesMsg.textContent='Elige quark y antiquark'; mesMsg.style.color='var(--text-secondary)';
      } else if(mesQ&&mesAQ&&COLORS[mesQ].anti===mesAQ){
        mesStatus.className='particle neutral'; mesLabel.textContent='¡Blanco!';
        mesMsg.textContent='Mesón neutro en color'; mesMsg.style.color='var(--accent)';
      } else {
        mesStatus.className='particle not-neutral'; mesLabel.textContent='Colorido';
        mesMsg.textContent='No es pareja color/anticolor'; mesMsg.style.color='var(--text-primary)';
      }
    }
    updMesColor();

    // ===== CARGA ELÉCTRICA =====
    const QUARKS = {
      u:{name:'Up',charge:2,sym:'u'},
      d:{name:'Down',charge:-1,sym:'d'},
      c:{name:'Charm',charge:2,sym:'c'},
      s:{name:'Strange',charge:-1,sym:'s'},
      t:{name:'Top',charge:2,sym:'t'},
      b:{name:'Bottom',charge:-1,sym:'b'}
    };
    const denom=3;
    const baryonNames={'uud':'Protón (p)','ddu':'Neutrón (n)'};
    const mesonNames={
      'u_d':'Pión⁺ (π⁺)','d_u':'Pión⁻ (π⁻)',
      'u_s':'Kaón⁺ (K⁺)','s_u':'Kaón⁻ (K⁻)'
    };
    function fmtCharge(num){
      if(num===0) return '0';
      const sign=num>0?'+':'-';
      const n=Math.abs(num);
      if(n%denom===0) return `${sign}${n/denom}e`;
      return `${sign}\\tfrac{${n}}{${denom}}e`;
    }
    function makeFlavorBtn(fl,anti=false){
      const b=document.createElement('button');
      b.dataset.fl=fl; b.dataset.anti=anti;
      b.className='flav-btn '+(anti?'anti-quark-btn':'quark-btn');
      const sym= anti?`\\bar{${QUARKS[fl].sym}}`:QUARKS[fl].sym;
      const ch = anti? -QUARKS[fl].charge: QUARKS[fl].charge;
      renderKaTeX(`${sym}\\;(${fmtCharge(ch)})`,b);
      return b;
    }
    // Barión carga eléctrica
    let barChState=[];
    const chBarDiv=document.getElementById('chgButtonsBar');
    const chSlotsBar=['slotCh0','slotCh1','slotCh2'].map(id=>document.getElementById(id));
    const resBarEl=document.getElementById('resultBar');
    const nameBarEl=document.getElementById('nameBar');
    Object.keys(QUARKS).forEach(f=>chBarDiv.appendChild(makeFlavorBtn(f,false)));
    chBarDiv.addEventListener('click',e=>{
      const fl=e.target.closest('button')?.dataset.fl;
      if(fl&&barChState.length<3){ barChState.push(fl); updBarCharge(); }
    });
    document.getElementById('resetChBar').onclick=()=>{
      barChState=[]; updBarCharge();
    };
    function updBarCharge(){
      let total=0;
      chSlotsBar.forEach((el,i)=>{
        const fl=barChState[i];
        if(fl){
          el.className='slot-chg quark-filled';
          el.textContent=QUARKS[fl].sym;
          total+=QUARKS[fl].charge;
        } else {
          el.className='slot-chg'; el.textContent='?';
        }
      });
      renderKaTeX(fmtCharge(total),resBarEl);
      if(barChState.length===3){
        const key=[...barChState].sort().join('');
        nameBarEl.textContent=baryonNames[key]||'Barión desconocido';
      } else {
        nameBarEl.textContent='Barión desconocido';
      }
    }
    updBarCharge();

    // Mesón carga eléctrica
    let mesQfl=null,mesAQfl=null;
    const chMesQDiv=document.getElementById('chgButtonsMesQ');
    const chMesAQDiv=document.getElementById('chgButtonsMesAQ');
    const slotQEl=document.getElementById('slotChQ');
    const slotAQEl=document.getElementById('slotChAQ');
    const resMesEl=document.getElementById('resultMes');
    const nameMesEl=document.getElementById('nameMes');
    Object.keys(QUARKS).forEach(f=>chMesQDiv.appendChild(makeFlavorBtn(f,false)));
    Object.keys(QUARKS).forEach(f=>chMesAQDiv.appendChild(makeFlavorBtn(f,true)));
    chMesQDiv.addEventListener('click',e=>{
      const fl=e.target.closest('button')?.dataset.fl;
      if(fl){ mesQfl=fl; updMesCharge(); }
    });
    chMesAQDiv.addEventListener('click',e=>{
      const fl=e.target.closest('button')?.dataset.fl;
      if(fl){ mesAQfl=fl; updMesCharge(); }
    });
    document.getElementById('resetChMes').onclick=()=>{
      mesQfl=mesAQfl=null; updMesCharge();
    };
    function updMesCharge(){
      let total=0;
      if(mesQfl){
        slotQEl.className='slot-chg quark-filled';
        slotQEl.textContent=QUARKS[mesQfl].sym;
        total+=QUARKS[mesQfl].charge;
      } else {
        slotQEl.className='slot-chg'; slotQEl.textContent='?';
      }
      if(mesAQfl){
        slotAQEl.className='slot-chg anti-filled';
        renderKaTeX(`\\bar{${QUARKS[mesAQfl].sym}}`,slotAQEl);
        total-=QUARKS[mesAQfl].charge;
      } else {
        slotAQEl.className='slot-chg'; slotAQEl.textContent='?';
      }
      if(mesQfl&&mesAQfl){
        renderKaTeX(fmtCharge(total),resMesEl);
        const key=`${mesQfl}_${mesAQfl}`;
        nameMesEl.textContent=mesonNames[key]||'Mesón desconocido';
      } else {
        resMesEl.textContent='';
        nameMesEl.textContent='Mesón desconocido';
      }
    }
    updMesCharge();
  </script>
</body>
</html>
